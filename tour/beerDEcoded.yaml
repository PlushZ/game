id: beerDEcoded
name: BeerDEcoded - StreetScienceCommunity
description: Workflow finds yeast strains contained in a sequenced beer sample.
title_default: <b>BeerDEcoded</b>
steps:
  - title: <b>BeerDEcoded - StreetScienceCommunity</b>
    content: >-
      Beer contains DNA that comes from its ingredients and some hundred microbes. There are 1,000+ yeasts used for brewing and 200+ hop varieties, each one bearing a different DNA and contributing to differentiate its properties.<br>
      Thanks to sequencing it is now easyer to find the different genomes contained in a beer sample and investigate their characteristics. The sequencing of the full genome of 157 brewing yeast strains was, for example, recently reported (<a href="https://pubmed.ncbi.nlm.nih.gov/27610566/">Gallone B, Steensels J, Prahl T, et al. 2016</a>).<br>
    backdrop: true      
  - title: <b>BeerDEcoded - StreetScienceCommunity</b>
    content: >-      
      Based on the identification of strains present in beer with desired characteristics, controlled experiments in which the microbial composition of the brew is altered could allow us to investigate if the presence of specific microorganisms affects flavour. The origin of each yeast species can be investigated; i.e. whether they come with the ingredients or from the environment at the production site. Furthermore, plant DNA, such as malt and hop varieties, can be found in beer samples, and the bacterial diversity can be mapped.
    backdrop: true
  - title: <b>Create a new history</b>
    element: '#history-new-button'
    intro: >-
      Let's start by creating a new history.<br>Click on the button <b>'Create
      new history'</b><br>
    position: left
    preclick:
      - '#center-panel'
  - title: <b>Rename the history</b>
    element: '#current-history-panel > div.controls'
    intro: Change the name of the new history to <b>'BeerDEcoded'</b>.
    position: left
  - title: <b>Uploading the input data</b>
    content: We need to upload data. We will start with a <b>fastq</b> file.<br>FASTQ format is a text-based format for storing both a biological sequence and its corresponding quality scores. Both the sequence letter and the quality score are encoded with a single ASCII character for brevity.<br>A FASTQ file normally uses four lines per sequence.<br><ul type="circle"> <li>Line 1 begins with a '@' character and is followed by a sequence identifier and an optional description.</li><li>Line 2 is the raw sequence letters.</li><li>Line 3 begins with a '+' character and is optionally followed by the same sequence identifier (and any description) again.</li><li>Line 4 encodes the quality values for the sequence in Line 2, and must contain the same number of symbols as letters in the sequence.</li> </ul><br>You can find more info in the <a href="https://en.wikipedia.org/wiki/FASTQ_format">Wikipedia article.</a>
    backdrop: true
  - title: <b>Uploading the input data</b>
    element: .upload-button
    intro: >-
      We will import fastq into the history we just created.<br><br> Click
      <b>'Next'</b> and the tour will open Galaxy Upload Manager and take you to
      the Upload screen.
    position: right
    postclick:
      - .upload-button
  - title: <b>Uploading the input data</b>
    intro: Upload the data by clicking the <b>'Paste/Fetch Data'</b> button.
  - title: <b>Uploading the input data</b>
    content: >-
      Load the data into your history by providing the links or choose your
      fastq file from your computer. <br>Click on <b>'Start'</b> to upload the
      data into your Galaxy history.
  - title: <b>Uploading the input data</b>
    content: >-
      The upload may take awhile.<br><br> Hit the <b>Close</b> button when you
      see that the files are uploaded into your history.
  - title: <b>Uploading the input data Complete !</b>
    content: 'Now that your data is ready, let''s analyze it!<br>'
    backdrop: true
  - title: <b>Assign taxonomic classifications</b>
    content: >-
      One of the key steps in metagenomic data analysis is to identify the taxon to which the individual read belongs. Taxonomic classification tools are using microbial genome databases to identify the origin of each sequence.<br>
    backdrop: true
  - title: <b>Taxonomic classification with Kraken2</b>
    content: >-
      To perform the taxonomic classification we will use Kraken2. This tool uses <a href="https://en.wikipedia.org/wiki/K-mer">k-mers</a> (the read’s subsequences of length k) to assign a taxonomic label to the sequence (if possible).<br>The taxonomic label is assigned based on matches of k-mer content of the considering sequence to the k-mer content of reference genome sequence. The result is a classification of the considering sequence to the most likely taxonomic label. If the k-mer content is not similar to any genomic sequence in the database used, it will not assign any taxonomic label.<br>
      <img src="kraken2_simlified.jpg" alt="Kraken2 simlified process image" width="400" height="400">
    backdrop: true
  - title: <b>Taxonomic classification with Kraken2</b>
    element: .toolMenuContainer
    intro: Available tools appear here in the <b>tool menu</b>.
    position: right
  - title: <b>Taxonomic classification with Kraken2</b>
    element: '#__BVID__106'
    content: >-
      You can use <b>'tool search'</b> to locate tools.<br><br> Search for 
      <b>'Kraken2'</b> and select it.<br><br> Tools may take a couple of moments
      to load.
    placement: right
  - title: <b>Taxonomic classification with Kraken2</b>
    element: .toolMenuContainer
    intro: >-
      Open <b>'Kraken2'</b> tool<br><br> Click <b>'Next'</b> to continue our
      tour.
    position: right
  - title: <b>Assign taxonomic labels with Kraken2</b>
    element: 'div[tour_id="use_names"]'
    intro: Have a look at the tool's parameters of the <b>'Kraken2'</b> tool.
    placement: right
  - title: <b>Assign taxonomic labels with Kraken2</b>
    intro: >-
      Please select the following parameters:<br><br> <b>'Single or paired
      reads'</b>: Single <br> <b>'Input sequences'</b>: Uploaded dataset<br>
      <b>'Print scientific names instead of just taxids'</b>: Yes<br>
      <b>'Confidence'</b>: 0.0<br> <b>'In “Create Report”'</b>:<br>
      &nbsp;&nbsp;&nbsp;&nbsp;<b>'Print a report with aggregrate counts/clade to
      file'</b>: Yes<br> &nbsp;&nbsp;&nbsp;&nbsp;<b>'Format report output like
      Kraken 1’s kraken-mpa-report'</b>: Yes<br> <b>'Select a Kraken2
      database'</b>: fungi2019-03' <br><br>Click <b>'Next'</b> and the tour will
      <b>'Execute'</b> the Kraken2 tool for you.'<br><br><br>      
      <small>Additional info:<br><b>Parameter ‘Single or paired reads’</b><br>Single-end reads are the fragments sequenced from one side. With paired-end sequencing, the fragments are sequenced from both sides. This approach results in two reads per fragment, with the first read in forward orientation and the second read in reverse-complement orientation. With this technique, we have the advantage to get more information about each DNA fragment compared to reads sequenced by only single-end sequencing<br><b>Parameter ‘Confidence'</b><br>A confidence score of 0.0 means that non-restrictive taxonomic assignation is desired. This value can be increased if a more restrictive taxonomic assignation is desired. For example, a confidence score of 0.1 means that at least 10% of the k-mers should match entries in the database. <br><b>Parameter ‘Select a Kraken2 database’</b><br>We need to identify the taxon to which the individual reads belong. To identify the origin of each sequence, taxonomic classification tools use  microbial genome databases. For this tutorial, we will use the <i>fungi2019-03</i> database.<small/><br>
    postclick:
      - '#execute'
  - title: <b>Assign taxonomic labels with Kraken2</b>
    element: '#current-history-panel > div.controls'
    intro: >-
      Congratulations, you have created two files. It contains Classification
      and Report file.<br><br> It will remain stored in your history.<br><br>
      Click the <b>'eye'</b> icon to view the data once the history item turns
      green.
    position: left
  - title: <b>Analyze taxonomic assigment</b>
    content: >-
      Once we have assigned the corresponding taxa to the sequence, the next
      step is to properly visualize the data, for which we will use the Krona
      pie chart tool (<a href="https://doi.org/10.1186/1471-2105-12-385">Ondov
      et al. 2011</a>).<br>
    backdrop: true
  - title: <b>Adjust dataset format</b>
    element: '#__BVID__106'
    intro: >-
      It can happen, that the output format of the tool needs to be changed in order for the next tool to read the data.Galaxy offers several "manipulation" tools.<br><br>The format of the file created after executing Kraken2 has a tabular format with one column and one line per taxon. Every line contains the information divided by | symbol. In order to make it more readable and usable by next tools we need a tab-delimited format with one line per taxon. The fields of the output, from left-to-right, should be as follows:1) Number of fragments assigned directly to this taxon; 2) A rank code, indicating (U)nclassified, (R)oot, (D)omain, (K)ingdom, (P)hylum, (C)lass, (O)rder, (F)amily, (G)enus, or (S)pecies.<br><br>Here we need to adjust the format of the data output from Kraken2.  <br><br> Search and select the <b>'Reverse'</b> tool.
    position: right
  - title: <b>Adjust dataset format</b>
    intro: >-
      You have selected the Reverse tool.<br> Ensure that for <b>'Input tabular
      dataset'</b> you have selected the report output file from
      Kraken2.<br><br> <b>'Execute'</b> the Reverse tool when you are ready.
    position: right
  - title: <b>Adjust dataset format</b>
    element: '#__BVID__106'
    intro: Search and select the <b>'Replace Text'</b> tool.
    position: right
  - title: <b>Adjust dataset format</b>
    intro: >-
      You have selected the Replace Text tool.<br><br> Please select the
      following parameters:<br><br> <b>'File to process'</b>: Output dataset
      'out_file' from 'Reverse' tool<br> <b>'In “Replacements”'</b>:<br>
      &nbsp;&nbsp;&nbsp;&nbsp;<b>'Replacement 1'</b>:<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>'Find pattern'</b>:
      \|<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>'Replace
      with:'</b>: \t<br> &nbsp;&nbsp;&nbsp;&nbsp;<b>'Replacement 2'</b>:<br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>'Find pattern'</b>:
      [a-z]__<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>'Replace
      with:'</b>: Empty <br><br>  <b>'Execute'</b> the Reverse tool when you are
      ready.
    position: right
  - title: <b>Visualize the taxonomical classification with Krona</b>
    content: >-
      <b>Krona</b> allows hierarchical data to be explored with zooming,
      multi-layered pie charts. With this tool, we can easily visualize the
      composition of the bacterial communities and compare how the populations
      of microorganisms are modified according to the conditions of the
      environment.
    backdrop: true
  - title: <b>Visualize metagenomics analysis results</b>
    element: '#__BVID__106'
    intro: Search and select the <b>'Krona pie chart'</b> tool.
    position: right
  - title: <b>Visualize metagenomics analysis results</b>
    intro: >-
      You have selected the 'Krona pie chart' tool.<br><br> Please select the
      following parameters:<br><br> <b>'What is the type of your input
      data'</b>: Tabular<br> <b>'Input file'</b>: Output dataset 'out_file' from
      'Replace Text' tool<br> <b>'Provide a name for the basal rank'</b>:
      Root<br> <b>'Combine data from multiple datasets?'</b>: No<br> <br><br>
      <b>'Execute'</b> the 'Krona pie chart' tool when you are ready.
    position: right
  - title: <b>Visualize metagenomics analysis results</b>
    element: '#current-history-panel > div.controls'
    intro: >-
      Let’s take a look at the result by clicking eye icon. Using the search bar
      we can check if certain taxa are present.
    position: left
    preclick:
      - '#center-panel'
  - title: <b>A tour BeerDEcoded</b>
    intro: >-
      You have reached the end of the tour.<br><br>Thank you for going through
      our tutorial.
    backdrop: true
